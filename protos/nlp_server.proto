// Copyright Aristech GmbH

syntax = "proto3";
import "projects.proto";
import "intents.proto";

option java_multiple_files = true;
option objc_class_prefix = "ATS";

package aristech.nlp;

/**
 * NLPServer provides the interface for various NLP functionalities.
 * These functions include text processing, content management in projects,
 * and interaction with vectorized data structures.
 */
service NLPServer {
  /**
   * GetFunctions
   * -------------
   * Returns all available processing functions (models) of the server.
   * Each function includes a unique ID, a descriptive name,
   * a description, and a list of possible arguments.
   *
   * Request: FunctionRequest
   * Response: stream Function
   */
  rpc GetFunctions(FunctionRequest) returns (stream Function) {}

  /**
   * RunFunctions
   * -------------
   * Processes the provided raw text using the specified functions.
   * Multiple functions can be applied sequentially.
   *
   * Request: RunFunctionsRequest
   *   - functions: List of functions to apply.
   *   - input: The raw text to process.
   *   - arguments: Additional parameters.
   * Response: RunFunctionsResponse (contains the processed text result)
   */
  rpc RunFunctions(RunFunctionsRequest) returns (RunFunctionsResponse) {}

  /**
   * UpdateContent
   * --------------
   * Adds new content or updates existing content.
   *
   * Request: UpdateContentRequest
   * Response: UpdateContentResponse
   */
  rpc UpdateContent(UpdateContentRequest) returns (UpdateContentResponse) {}

  /**
   * RemoveContent
   * --------------
   * Removes the specified content.
   *
   * Request: RemoveContentRequest
   * Response: RemoveContentResponse
   */
  rpc RemoveContent(RemoveContentRequest) returns (RemoveContentResponse) {}

  /**
   * GetContent
   * ----------
   * Retrieves content that is available both as vectorized data and as plain text.
   *
   * Request: GetContentRequest
   * Response: stream GetContentResponse
   */
  rpc GetContent(GetContentRequest) returns (stream GetContentResponse) {}

  /**
   * AddProject
   * -----------
   * Initializes a new project.
   *
   * Request: AddProjectRequest
   * Response: AddProjectResponse
   */
  rpc AddProject(AddProjectRequest) returns (AddProjectResponse) {}

  /**
   * RemoveProject
   * --------------
   * Removes an existing project and all associated content.
   *
   * Request: RemoveProjectRequest
   * Response: RemoveProjectResponse
   */
  rpc RemoveProject(RemoveProjectRequest) returns (RemoveProjectResponse) {}

  /**
   * UpdateProject
   * --------------
   * Updates the settings or configuration of an existing project.
   *
   * Request: UpdateProjectRequest
   * Response: UpdateProjectResponse
   */
  rpc UpdateProject(UpdateProjectRequest) returns (UpdateProjectResponse) {}

  /**
   * GetProjects
   * -----------
   * Returns a list of all projects.
   *
   * Request: GetProjectsRequest
   * Response: stream Project
   */
  rpc GetProjects(GetProjectsRequest) returns (stream Project) {}

  /**
   * GetIntents
   * ----------
   * Retrieves all intents of a project.
   *
   * Request: GetIntentsRequest
   * Response: stream Intent
   */
  rpc GetIntents(GetIntentsRequest) returns (stream Intent) {}

  /**
   * GetScoreLimits
   * ---------------
   * Determines score limits for a project based on test inputs.
   *
   * Request: GetScoreLimitsRequest
   * Response: GetScoreLimitsResponse
   */
  rpc GetScoreLimits(GetScoreLimitsRequest) returns (GetScoreLimitsResponse) {}

  /**
   * GetEmbeddingModels
   * -------------------
   * Returns a list of available embedding models for similarity searches.
   *
   * Request: GetEmbeddingModelsRequest
   * Response: stream EmbeddingModel
   */
  rpc GetEmbeddingModels(GetEmbeddingModelsRequest) returns (stream EmbeddingModel) {}

  rpc SyncDBs(SyncDBsRequest) returns (SyncDBsResponse) {}
}

/**
 * FunctionRequest
 * ---------------
 * Request for the list of functions provided by the server.
 */
message FunctionRequest {}


/**
 * Function
 * --------
 * Describes a specific operation that can be applied to incoming text,
 * such as classification or recasing.
 */
message Function {
  // Unique identifier of the function.
  string id = 1;
  // Descriptive name of the function.
  string name = 2;
  // Detailed description of the function.
  string description = 3;
  // List of arguments accepted by the function.
  repeated string arguments = 4;
}


/**
 * RunFunctionsRequest
 * -------------------
 * Request to process raw text using specified functions.
 */
message RunFunctionsRequest {
  // List of functions to apply.
  repeated Function functions = 1;
  // The raw text to process.
  string input = 2;
  // Additional parameters for the functions.
  repeated string arguments = 3;
}


/**
 * RunFunctionsResponse
 * --------------------
 * Response message containing the result of text processing.
 */
message RunFunctionsResponse {
  // The processed text result.
  string output = 1;
}

message SyncDBsRequest {}

message SyncDBsResponse {
  string status = 1;
}